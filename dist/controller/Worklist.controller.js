sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox"],function(e,t,i,a,s,r){"use strict";return e.extend("com.bizim.depotransfer.ZMM007_DEPO_TRANSFER.controller.Worklist",{formatter:i,onInit:function(){var e,e=new t({worklistTableTitle:this.getResourceBundle().getText("worklistTableTitle"),saveAsTileTitle:this.getResourceBundle().getText("saveAsTileTitle",this.getResourceBundle().getText("worklistViewTitle")),shareOnJamTitle:this.getResourceBundle().getText("worklistTitle"),shareSendEmailSubject:this.getResourceBundle().getText("shareSendEmailWorklistSubject"),shareSendEmailMessage:this.getResourceBundle().getText("shareSendEmailWorklistMessage",[location.href]),tableNoDataText:this.getResourceBundle().getText("tableNoDataText"),tableBusyDelay:0});this.setModel(e,"worklistView")},onUpdateFinished:function(e){var t,i=e.getSource(),a=e.getParameter("total");if(a&&i.getBinding("items").isLengthFinal()){t=this.getResourceBundle().getText("worklistTableTitleCount",[a])}else{t=this.getResourceBundle().getText("worklistTableTitle")}this.getModel("worklistView").setProperty("/worklistTableTitle",t)},onPress:function(e){this._showObject(e.getSource())},onValueHelpBtnTeslimat:function(e){if(!this._Teslimatlar){this._Teslimatlar=sap.ui.xmlfragment("com.bizim.depotransfer.ZMM007_DEPO_TRANSFER.fragments.Teslimat",this)}this.oViewModel=this.getOwnerComponent().getModel("worklistView");sap.ui.getCore().setModel(this.oViewModel,"worklistView");var t=this.getModel("worklistView");t.setProperty("/dialogbusy",true);var i=new sap.ui.model.odata.ODataModel("/sap/opu/odata/SAP/ZMM007_TRANSFER_RF_SRV/",true);i.read("/Zmm008ShTesSet",{success:function(e){t.setProperty("/Zmm008ShTes",e.results)},error:function(e){try{var t=JSON.parse(e.responseText);t=t.error.message.value}catch(i){t=e.message}sap.m.MessageBox.alert(t,{icon:sap.m.MessageBox.Icon.ERROR,title:"Hata Oluştu!"});sap.ui.core.BusyIndicator.hide(0)}});this.getView().addDependent(this._Teslimatlar);this._Teslimatlar.open()},_handleValueHelpSearchTeslimat:function(e){var t=e.getParameter("value");var i=new a({filters:[new a("Vbeln",sap.ui.model.FilterOperator.Contains,t),new a("Kunnr",sap.ui.model.FilterOperator.Contains,t),new a("Vstel",sap.ui.model.FilterOperator.Contains,t)],and:false});e.getSource().getBinding("items").filter(i)},_handleValueHelpCloseTeslimat:function(e){var t=this;var i=e.getParameter("selectedItem");if(i){t.getView().byId("idGondTeslimat").setValue(i.getTitle().slice(13,23))}e.getSource().getBinding("items").filter([])},onValueHelpBtn:function(e){if(!this._MatbuIrsaliye){this._MatbuIrsaliye=sap.ui.xmlfragment("com.bizim.depotransfer.ZMM007_DEPO_TRANSFER.fragments.MatbuIrsaliye",this)}this.oViewModel=this.getOwnerComponent().getModel("worklistView");sap.ui.getCore().setModel(this.oViewModel,"worklistView");var t=this.getModel("worklistView");t.setProperty("/dialogbusy",true);var i=new sap.ui.model.odata.ODataModel("/sap/opu/odata/SAP/ZMM007_TRANSFER_RF_SRV/",true);i.read("/Zmm008ShLifexSet",{success:function(e){t.setProperty("/Zmm008ShLifex",e.results)},error:function(e){try{var t=JSON.parse(e.responseText);t=t.error.message.value}catch(i){t=e.message}sap.m.MessageBox.alert(t,{icon:sap.m.MessageBox.Icon.ERROR,title:"Hata Oluştu!"});sap.ui.core.BusyIndicator.hide(0)}});this.getView().addDependent(this._MatbuIrsaliye);this._MatbuIrsaliye.open()},handleTableValueHelpConfirm:function(e){var t=e.getParameter("selectedItem");if(t){this.byId(this.inputId).setValue(t.getBindingContext().getObject().Lifex);this.readRefresh(e)}this.oDialog.destroy()},handleValueHelpMatbuIrsaliye:function(e){var t=e.getParameter("value");var i=new a("Lifex",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([i])},_handleValueHelpMatbuIrsaliye:function(e){var t=this;var i=e.getParameter("selectedItem");if(i){t.byId("idMatbuIrsaliye").setValue(i.getTitle())}},onShareInJamPress:function(){var e=this.getModel("worklistView"),t=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:location.href,share:e.getProperty("/shareOnJamTitle")}}});t.open()},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var i=e.getParameter("query");if(i&&i.length>0){t=[new a("Arktx",s.Contains,i)]}this._applySearch(t)}},onRefresh:function(){var e=this.byId("table");e.getBinding("items").refresh()},_showObject:function(e){this.getRouter().navTo("object",{objectId:e.getBindingContext().getProperty("Xblnr")})},_applySearch:function(e){var t=this.byId("table"),i=this.getModel("worklistView");t.getBinding("items").filter(e,"Application");if(e.length!==0){i.setProperty("/tableNoDataText",this.getResourceBundle().getText("worklistNoDataWithSearchText"))}},onPage2Barkod:function(){var e=this;if(e.byId("idEirsaliye").getValue()!==""||e.byId("idMatbuIrsaliye").getValue()!==""||e.byId("idGondTeslimat").getValue()!==""){var t="";var i=this.getModel("worklistView");var a=new sap.ui.model.odata.ODataModel("/sap/opu/odata/SAP/ZMM007_TRANSFER_RF_SRV/",true);t=a.createKey("/GetPage1Set",{Xblnr:e.byId("idEirsaliye").getValue(),Lifex:e.byId("idMatbuIrsaliye").getValue(),VbelnVl:e.byId("idGondTeslimat").getValue(),PCheck:"X"});sap.ui.core.BusyIndicator.show(0);a.read(t,{success:function(t){sap.ui.core.BusyIndicator.hide();if(t.Type==="S"){e.route()}},error:function(e){sap.ui.core.BusyIndicator.hide();var t=JSON.parse(e.response.body);sap.m.MessageBox.show(t.error.message.value,{icon:sap.m.MessageBox.Icon.ERROR,duration:9e3,width:"20em"})}})}else{sap.m.MessageBox.show("E-irsaliye No , Matbu İrsaliye No veya teslimatı doldurunuz. ",{icon:sap.m.MessageBox.Icon.ERROR,duration:9e3,width:"20em"})}},route:function(){var e=this;var t={Eirsaliye:e.getView("worklistView").byId("idEirsaliye").getValue(),MatbuIrsaliye:e.getView("worklistView").byId("idMatbuIrsaliye").getValue(),GondTeslimat:e.getView("worklistView").byId("idGondTeslimat").getValue()};var i=JSON.stringify(t);this.getRouter().navTo("BarkodPage",{Type:"U",data:i},false)}})});